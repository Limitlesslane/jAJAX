/*
 The ? License
  @version 1.0.1
  @git https://github.com/duzun/jAJAX
  @umd AMD, Browser, CommonJs
  @author DUzun.Me
*/
(function(z,q,u,v,w){("function"==typeof define&&define.amd?define:"undefined"!=typeof module&&module.exports?function(q,r){module.exports=r()}:function(u,r){q[z]=r()})([],function(){var A=u.noop||function(){},r=u.prototype.hasOwnProperty,D="function"==typeof w.now?function(){return w.now()}:function(){return new w.getTime},p=function(f,h){if(!f)return f;var a,d,g="length";if(f instanceof v||r.call(f,g)&&"number"===typeof f[g]&&"function"!=typeof f)for(a=0,g=f[g]>>>0;a<g;a++){if(r.call(f,a)&&(d=f[a],
!1===h.call(d,a,d,f)))return a}else for(a in f)if(r.call(f,a)&&(d=f[a],!1===h.call(d,a,d,f)))return a;return f},E=function(f){function h(a,d){f[a]=d}p(arguments,function(a,d){a&&p(d,h)});return f},e="undefined"!==typeof self&&"function"==typeof self.setTimeout?self:q;"function"!=typeof e.setTimeout&&"undefined"!==typeof require&&(e=require("sdk/timers"));var x=e.setTimeout,F=e.clearTimeout,B={"*":"*/*",text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},
e=function h(a,d,g){var b=h.createXHR(!1);if(!b)return g&&g("Couldn't create XHR object"),b;"string"==typeof a&&(a={url:a});a=E({url:"",type:"GET",cache:!1,timeout:null,contentType:"application/x-www-form-urlencoded; charset=UTF-8",dataType:"",mimeType:"",data:null,headers:null,error:null,success:null},a);var e={},k=function(a,c){e[a.toLowerCase()]=[a,c]},c=a.type,t,l=function(C,c,d,l){a.error&&a.error(d||l,c,C,l);g&&g(d||l,c,C,l)},G=function(c,y){var b=c.responseText,t=a.dataType||h.mimeToDataType(a.mimeType||
c.getResponseHeader("content-type")),g;try{switch(t){case "json":b="responseJSON"in c?c.responseJSON:/^\s*$/.test(b)?null:h.parseJSON(b);break;case "xml":b=c.responseXML;break;case "script":(0,eval)(b)}}catch(m){g=m}g?l(g,"parsererror",c,y):(a.success&&a.success(b,c.statusText,c,y),d&&d(b,c.statusText,c,y))},m=function(a,c){t&&F(t);200<=a.status&&300>a.status||304==a.status?G(a,c):l(a.statusText||null,a.status?"error":"abort",a,c)};p({"X-Requested-With":"XMLHttpRequest"},k);a.contentType&&k("Content-Type",
a.contentType);k("Accept",(B[a.dataType]?B[a.dataType]+", ":"")+"*/*; q=0.01");p(a.headers,k);if("REQUEST"==h.xhr_type){p(a.data,function(a,c,b){null==c&&delete b[a]});var s={url:a.url,content:a.data?a.data:{},headers:{},onComplete:function(a){s.aborted||m({getResponseHeader:function(c){return a.headers[c]},status:a.status,statusText:a.statusText,responseText:a.text,responseJSON:a.json},a)}};p(e,function(a,c){c[0]&&null!=c[0]&&(s.headers[c[0]]=c[1])});a.contentType&&(s.contentType=a.contentType);
0<a.timeout&&(t=x(function(){s.aborted=D();l(null,"timeout",b)},a.timeout));c=c.toLowerCase();try{b.Request(s)[c]()}catch(r){try{s.headers["X-HTTP-Method-Override"]=c.toUpperCase(),b.Request(s).post()}catch(q){switch(c){case "delete":var n=new (require("sdk/net/xhr").XMLHttpRequest);n.open(c,a.url);p(s.headers,function(a,c){n.setRequestHeader(a,c)});n.send();m(n);break;default:throw q;}}}}else c=c.toUpperCase(),b.open(c,a.url,!0),p(e,function(a,c){null!=c[1]&&b.setRequestHeader(c[0],c[1]+"")}),0<
a.timeout&&(t=x(function(){b.onreadystatechange=A;b.abort();l(null,"timeout",b)},a.timeout)),k=function(){4==b.readyState&&(b.onreadystatechange=A,m(b))},b.send(a.data?h.param(a.data):null),4===b.readyState?x(k):b.onreadystatechange=k;return b};(function(h,a,d){function g(a,b,d,e){var m,h=b instanceof v,k=b&&b!==q&&!h&&u.getPrototypeOf(b)==u.prototype;p(b,function(b,n){m=n instanceof v?"array":typeof n;e&&(b=d?e:e+"["+(k||"object"==m||"array"==m?b:"")+"]");!e&&h?a.add(n.name,n.value):"array"==m||
!d&&"object"==m?g(a,n,d,b):a.add(b,n)})}d.param=function(a,b){var d=[];d.add=function(a,c){this.push(h(a)+(null==c?"":"="+h(c)))};g(d,a,b);return d.join("&").replace(/%20/g,"+")};var b=/^(?:text|application)\/javascript/i,e=/^(?:text|application)\/xml/i;d.mimeToDataType=function(a){a&&(a=a.split(";",2)[0]);return a&&("text/html"==a?"html":"application/json"==a?"json":b.test(a)?"script":e.test(a)&&"xml")||"text"};var k=a&&a.parse||q.json_decode;d.parseJSON=function(a){try{return k(a)}catch(b){var d=
a.replace(/[\n\r]+\s*\/\/[^\n\r]*/g,"");if(d!=a)return k(d);throw b;}};d.createXHR=function(a){p({XMLHttpRequest:function(){return new q.XMLHttpRequest},MSXML2:function(){return new ActiveXObject("Msxml2.XMLHTTP")},MSXML:function(){return new ActiveXObject("Microsoft.XMLHTTP")},MSXML24:function(){return new ActiveXObject("Msxml2.XMLHTTP.4.0")},REQUEST:function l(){return l.xhr||(l.xhr=require("sdk/request"))}},function(b,e){try{return a=e(),d.createXHR=e,d.xhr_type=b,!1}catch(g){}});return a};d.xhr_supported=
d.createXHR(!1)})(encodeURIComponent,JSON,e);e.name=z;return e})})("jajax",this,Object,Array,Date);
